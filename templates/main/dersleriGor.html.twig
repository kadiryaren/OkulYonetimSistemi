{% extends 'base.html.twig' %}

{% block title %}Ogrenciler{% endblock %}

{% block body %}

<link rel="stylesheet" href="{{ asset('css/ogrenciStyle.css') }}" />

    <style>
        .homepage-button{
            position:absolute;
            top:3vh;
            left: 3vw;
        }
        body{
            background-color: white !important;
        }
        {% if is_granted("ROLE_OGRETMEN") and is_granted('ROLE_OGRENCI') %}
            #navbarTogglerDemo01{
                        height: 100vh !important;
                    }
        {% endif %}
        

    </style>



<div class="main">
        <nav class="navbar  navbar-expand-lg navbar-expand-md navbar-expand-sm navbar-expand-xl navbar-dark" id="navbar">
        <!--  -->
            <button id="collapseButton" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation" onclick="changeColor()">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse flex-column" id="navbarTogglerDemo01">
                <div class="kapsayici-div d-flex flex-column justify-content-center align-items-center">
                    <div class="nav-header d-flex flex-column justify-content-center align-items-center ">
                        <div class="mb-2 username-field">
                            {{ user.username }}
                        </div>
                        <div class=" yetki-kapsayici d-flex justify-content-center align-items-center">
                            <div class="yetki">
                                yetki:
                            </div>
                            <div>
                            <h3><span class="badge badge-success">
                            {% if is_granted("ROLE_OGRENCI") %}
                                    ogrenci
                                {% elseif is_granted("ROLE_OGRETMEN") %}
                                    ogretmen
                                    {% elseif is_granted("ROLE_YONETICI") %}
                                    yonetici
                            {% endif %}
                            
                            </span></h3>
                            </div>
                        </div>
                    </div>
                    {% if is_granted("ROLE_OGRENCI") %}
                        <div class="route d-flex justify-content-center align-items-center">
                            <a href="{{ path('ogrenci.account') }}">Kullanici Bilgileri</a>
                        </div>
                        <div class="route d-flex justify-content-center align-items-center">
                            <a  href="{{ path('ogrenci.dersleri.gor') }}">Dersleri Gor</a>
                        </div>
                    {% endif %}
                    {% if is_granted("ROLE_OGRETMEN") %}
                        <div class="route d-flex justify-content-center align-items-center">
                            <a href="{{ path('ogretmen.account') }}">Kullanici Bilgileri</a>
                        </div>
                        <div class="route d-flex justify-content-center align-items-center">
                            <a  href="{{ path('ogretmen.dersleri.gor') }}">Dersleri Gor</a>
                        </div>
                    {% endif %}
                    {% if is_granted("ROLE_YONETICI") %}<div class="route d-flex justify-content-center align-items-center">
                            <a href="{{ path('yonetici.account') }}">Kullanici Bilgileri</a>
                        </div>
                        <div class="route d-flex justify-content-center align-items-center">
                            <a  href="{{ path('yonetici.ogrencileri.gor') }}">Ogrencileri Gor</a>
                        </div>
                         <div class="route d-flex justify-content-center align-items-center">
                            <a  href="{{ path('ogrenci-kayit') }}">Ogrenci Kayit</a>
                        </div>
                        <div class="route d-flex justify-content-center align-items-center">
                            <a href="{{ path('ogretmenleri.gor') }}">Ogretmenleri Gor</a>
                        </div>
                        <div class="route d-flex justify-content-center align-items-center">
                            <a  href="{{ path('yoneticileri.gor') }}">Yoneticileri Gor</a>
                        </div>
                        <div class="route d-flex justify-content-center align-items-center">
                            <a  href="{{ path('yonetici.dersleri.gor') }}">Dersleri Gor</a>
                        </div>
                        <div class="route d-flex justify-content-center align-items-center">
                            <a  href="{{ path('ders.ekle') }}">Ders Ekle</a>
                        </div>
                        <div class="route d-flex justify-content-center align-items-center">
                            <a  href="{{ path('ogretmen.kayit') }}">Ogretmen Ekle</a>
                        </div>
                        <div class="route d-flex justify-content-center align-items-center">
                            <a  href="{{ path('yonetici.kayit') }}">Yonetici Ekle</a>
                        </div>
                    {% endif %}

                    <br>
                    <hr>
    
                </div>
                <div class="cikis d-flex justify-content-center align-items-center">
                    <a  href="{{ path('app_logout') }}">Cikis Yap</a> 
                </div>
              
              
            </div>
            
        </nav>
    
        <div class="duyurular-container d-flex flex-column justify-content-center align-items-center">
        {% for message in app.flashes('ders-sil') %}
            <div class="alert alert-danger text-center" style="width: 100%;">
                {{ message }}
            </div>
        {% endfor %}

            <div class="d-flex flex-column justify-content-center align-items-center mt-5">
                <div style="width:90%;">
                <center><h1>Kayitli Dersler</h1></center>
                {% if is_granted("ROLE_OGRENCI") %}
                    <center><h3>Kalan Kredi {{ ogrenci.getKredi() }}</h3></center>
                {% endif %}
                
                <table id="example" class="table table-striped table-bordered" style="width:100%">
                    <thead>
                        <tr>
                                <th>Ders ID</th>
                                <th>Ders Adi</th>
                                <th>Ders Fiyati</th>
                                <th>Ogretmen Ucreti</th>
                                <th>Hangi Sinifta Alinabilir</th>
                                <th>Ders Kredisi</th>
                                <th>Ders Gunu</th>
                                <th>Egitmen</th>
                                <th>Ogrenciler</th>
                                <th>Ekle/Sil</th>
                                        
                                
                                

                                
                        </tr>
                    </thead>
                    <tbody>
                    {% for ders in dersler %}
                                <tr>
                                    <td>
                                        {{ ders.getId() }}
                                        
                                    </td>
                                    <td>
                                        {{ ders.dersAdi() }}
                                    </td>
                                    <td>
                                        {{ ders.DersFiyati }}
                                    </td>
                                    <td>
                                        {{ ders.ogretmenUcreti }}
                                    </td>
                                
                                    <td>
                                        {{ ders.hangiSiniftaAlinabilir }}
                                    </td>
                                    <td>
                                        {{ ders.dersKredisi }}
                                    </td>
                                    <td>
                                        {{ ders.dersGunu|date("Y/m/d") }}
                                    </td>
                                    {% if is_granted("ROLE_YONETICI") %}
                                        <td>
                                        {% for hoca in ders.getOgretmen() %}
                                            {% if hoca != ogretmen %}
                                                {{ hoca.username }}
                                            {% endif %}
                                            
                                        
                                        {% endfor %}
                                        </td>
                                        {% if ders.getOgrenci()|length > 0 %}
                                            <td>
                                                {% for forOgrenci in  ders.getOgrenci() %}
                                                        
                                                            {{ forOgrenci.username }}
                                                {% endfor %}
                                            </td>
                                            {% else %}
                                            <td>
                                                Derse kayitli ogrenci yok!
                                            </td>
                                        {% endif %}
                                        <td>
                                            <a class="btn btn-danger"  href={{ path("yonetici.ders-sil",{dersid:ders.id}) }}>Sil</a>
                                        </td>

                                    {% endif %}
                                    
                                    {% if is_granted("ROLE_OGRENCI") %}
                                        <td>
                                        {% if  ders.getOgretmen()|length > 0 %}
                                            {% for hoca in ders.getOgretmen() %}
                                                {{ hoca.username }}
                                            {% endfor %}

                                        {% else %}
                                            Egitmen Atanmadi!
                                        {% endif %}
                                        
                                        </td>
                                        {% if ogrenciderseAidiyetKontrol(ders.getOgrenci(),ogrenci) %}
                                            <td>
                                                <h5><span class="badge badge-warning">Siz</span></h5>
                                                {% for forOgrenci in  ders.getOgrenci() %}
                                                    {% if forOgrenci != ogrenci %}
                                                        ,{{ forOgrenci.username }}
                                                    {% endif %}
                                                    
                                                {% endfor %}
                                            </td>
                                        {% else %}
                                    {% if ders.getOgrenci()|length > 0 %}
                                        <td>
                                            {% for forOgrenci in  ders.getOgrenci() %}
                                                    
                                                        ,{{ forOgrenci.username }}
                                            {% endfor %}
                                        </td>
                                        {% else %}
                                        <td>
                                            Derse kayitli ogrenci yok!
                                        </td>
                                    {% endif %}


                                    

                                        {% endif %}
                                        {% if  ogrenciderseAidiyetKontrol(ders.getOgrenci(),ogrenci) %}
                                            {# Ders Silme linki #}
                                            <td>
                                            <a class="btn btn-sm btn-danger" href="{{ path('ogrenci.dersten-ayril',{dersid:ders.getId()}) }}">Dersten Ayril</a>
                                            </td>
                                        {% else %}
                                            {# Ders Ekleme linki #}
                                            <td>
                                            {% if not  ders.getOgretmen()|length > 0  %}
                                                <h5><span class="badge badge-danger">Derse Katilamazsiniz!</span></h5>
                                                {% else %}
                                                <a class="btn btn-sm btn-success" href="{{ path('ogrenci.derse-katil',{dersid:ders.getId()}) }}">Katil</a>
                                            {% endif %}
                                            
                                            </td>
                                        {% endif %}
                                        
                                        


                                    {% endif %}

                                
                                    {% if is_granted("ROLE_OGRETMEN") %}
                                        {% if derseAidiyetKontrol(ders.getOgretmen(),ogretmen) == true %}
                                            <td>
                                                <h5><span class="badge badge-warning">Siz</span></h5>
                                                {% for hoca in ders.getOgretmen() %}
                                                    {% if hoca != ogretmen %}
                                                        {{ hoca.username }}
                                                    {% endif %}
                                                    
                                                {% endfor %}
                                            </td>
                                            {% if ders.getOgrenci()|length > 0 %}
                                                <td>
                                                    {% for forOgrenci in  ders.getOgrenci() %}
                                                            
                                                                {{ forOgrenci.username }}
                                                    {% endfor %}
                                                </td>
                                                {% else %}
                                                <td>
                                                    Derse kayitli ogrenci yok!
                                                </td>
                                            {% endif %}
                                            
                                            
                                            <td>
                                                <h4><span class="badge badge-info">Derse Aitsiniz</span></h4>
                                                <a class="btn btn-sm btn-dark" href="{{ path('ogretmen.derstenAyril',{id:ders.getId()}) }}">Dersten Ayril</a>
                                            </td>
                                        
                                        {% else %}
                                            <td>
                                                {% for hoca in ders.getOgretmen() %}
                                                    {{ hoca.username }},
                                                {% endfor %}
                                            </td>
                                            {% if ders.getOgrenci()|length > 0 %}
                                                <td>
                                                    {% for forOgrenci in  ders.getOgrenci() %}
                                                            
                                                                {{ forOgrenci.username }}
                                                    {% endfor %}
                                                </td>
                                                {% else %}
                                                <td>
                                                    Derse kayitli ogrenci yok!
                                                </td>
                                            {% endif %}
                                            <td>
                                                <a class="btn btn-sm btn-warning" href="{{ path('ogretmen.derseKatil',{id:ders.getId()}) }}">Derse Katil</a>
                                            </td>
                                        {% endif %}
                                        
                                    
                                    {% endif %}
                                    
                                    
                                    

                                </tr>
                            {% endfor %}
                    </tbody>
                    <tfoot>
                        <tr>
                                <th>Ders ID</th>
                                <th>Ders Adi</th>
                                <th>Ders Fiyati</th>
                                <th>Ogretmen Ucreti</th>
                                <th>Hangi Sinifta Alinabilir</th>
                                <th>Ders Kredisi</th>
                                <th>Ders Gunu</th>
                                <th>Egitmen</th>
                                <th>Ogrenciler</th>
                                <th>Ekle/Sil</th>
                                
                        </tr>
                    </tfoot>
                </table>
                </div>
            </div>


            <script>

            $(document).ready(function() {
                $('#example').DataTable();
            } );

            </script>

            
        </div>

    </div>


    





{% endblock %}
